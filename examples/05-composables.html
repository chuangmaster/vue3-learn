<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 - Composables æ·±å…¥å­¸ç¿’</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #2c3e50;
        }
        .example {
            margin: 20px 0;
            padding: 15px;
            border: 2px solid #16a085;
            border-radius: 5px;
            background: #e8f8f5;
        }
        .code {
            background: #f4f4f4;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            font-size: 0.9em;
        }
        button {
            background: #16a085;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #138d75;
        }
        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px;
        }
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .tip-box {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .best-practice {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .warning {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            padding: 12px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .composable-demo {
            border: 2px dashed #16a085;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            background: #f0fcfa;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§© ç¬¬äº”èª²ï¼šComposables æ·±å…¥å­¸ç¿’</h1>
        
        <h2>ğŸ¯ ä»€éº¼æ˜¯ Composablesï¼Ÿ</h2>
        <p>Composables æ˜¯åˆ©ç”¨ Vue çš„ Composition API ä¾†å°è£å’Œå¾©ç”¨**æœ‰ç‹€æ…‹é‚è¼¯**çš„å‡½æ•¸ã€‚å®ƒå€‘è®“æˆ‘å€‘èƒ½å¤ å°‡çµ„ä»¶é‚è¼¯æŠ½å–åˆ°å¤–éƒ¨å‡½æ•¸ä¸­ï¼Œå¯¦ç¾é‚è¼¯å¾©ç”¨ã€‚</p>
        
        <div class="highlight">
            <strong>ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µï¼š</strong><br>
            â€¢ ä»¥ <code>use</code> ç‚ºå‰ç¶´å‘½å<br>
            â€¢ å°è£éŸ¿æ‡‰å¼ç‹€æ…‹å’Œç›¸é—œé‚è¼¯<br>
            â€¢ å¯ä»¥åœ¨multipleçµ„ä»¶ä¸­å¾©ç”¨<br>    
            â€¢ æ”¯æŒçµ„åˆå’ŒåµŒå¥—ä½¿ç”¨
        </div>

        <!-- ç¯„ä¾‹ 1ï¼šç°¡å–®çš„è¨ˆæ•¸å™¨ Composable -->
        <div class="example">
            <h3>ç¯„ä¾‹ 1ï¼šåŸºç¤ Composable - useCounter</h3>
            <div class="composable-demo">
                <div id="app1"></div>
            </div>
            <div class="code">
// composables/useCounter.js
function useCounter(initialValue = 0) {
  const count = Vue.ref(initialValue)
  
  function increment() {
    count.value++
  }
  
  function decrement() {
    count.value--
  }
  
  function reset() {
    count.value = initialValue
  }
  
  // è¿”å›éŸ¿æ‡‰å¼ç‹€æ…‹å’Œæ–¹æ³•
  return {
    count,
    increment,
    decrement,
    reset
  }
}

// åœ¨çµ„ä»¶ä¸­ä½¿ç”¨
setup() {
  const { count, increment, decrement, reset } = useCounter(10)
  return { count, increment, decrement, reset }
}</div>
            
            <div class="best-practice">
                <strong>âœ… æœ€ä½³å¯¦è¸ï¼š</strong>Composable æ‡‰è©²åªè¿”å› refsï¼Œé€™æ¨£åœ¨è§£æ§‹æ™‚èƒ½ä¿æŒéŸ¿æ‡‰å¼ã€‚
            </div>
        </div>

        <!-- ç¯„ä¾‹ 2ï¼šæ»‘é¼ ä½ç½®è¿½è¸ª -->
        <div class="example">
            <h3>ç¯„ä¾‹ 2ï¼šå¯¦ç”¨ Composable - useMouse</h3>
            <div class="composable-demo">
                <div id="app2"></div>
            </div>
            <div class="code">
// composables/useMouse.js
function useMouse() {
  const x = Vue.ref(0)
  const y = Vue.ref(0)
  
  function updateMouse(event) {
    x.value = event.pageX
    y.value = event.pageY
  }
  
  Vue.onMounted(() => {
    window.addEventListener('mousemove', updateMouse)
  })
  
  Vue.onUnmounted(() => {
    window.removeEventListener('mousemove', updateMouse)
  })
  
  return { x, y }
}</div>
            
            <div class="tip-box">
                <strong>ğŸ–±ï¸ å¯¦éš›æ‡‰ç”¨ï¼š</strong>é€™å€‹ Composable å¯ä»¥ç”¨æ–¼æ‹–æ‹½ã€æ‡¸åœæ•ˆæœã€ç¹ªåœ–æ‡‰ç”¨ç­‰å ´æ™¯ã€‚
            </div>
        </div>

        <!-- ç¯„ä¾‹ 3ï¼šæœ¬åœ°å„²å­˜ -->
        <div class="example">
            <h3>ç¯„ä¾‹ 3ï¼šæœ¬åœ°å„²å­˜ Composable - useLocalStorage</h3>
            <div class="composable-demo">
                <div id="app3"></div>
            </div>
            <div class="code">
// composables/useLocalStorage.js
function useLocalStorage(key, defaultValue) {
  // å¾ localStorage è®€å–åˆå§‹å€¼
  function read() {
    try {
      const item = window.localStorage.getItem(key)
      return item ? JSON.parse(item) : defaultValue
    } catch {
      return defaultValue
    }
  }
  
  const storedValue = Vue.ref(read())
  
  // å¯«å…¥ localStorage
  function setValue(value) {
    try {
      storedValue.value = value
      window.localStorage.setItem(key, JSON.stringify(value))
    } catch (error) {
      console.error(`Error setting localStorage key "${key}":`, error)
    }
  }
  
  return [storedValue, setValue]
}</div>
        </div>

        <!-- ç¯„ä¾‹ 4ï¼šAPI è«‹æ±‚ Composable -->
        <div class="example">
            <h3>ç¯„ä¾‹ 4ï¼šAPI è«‹æ±‚ Composable - useFetch</h3>
            <div class="composable-demo">
                <div id="app4"></div>
            </div>
            <div class="code">
// composables/useFetch.js
function useFetch(url) {
  const data = Vue.ref(null)
  const error = Vue.ref(null)
  const loading = Vue.ref(false)
  
  async function fetchData() {
    loading.value = true
    error.value = null
    
    try {
      // æ¨¡æ“¬ API è«‹æ±‚å»¶é²
      await new Promise(resolve => setTimeout(resolve, 1000))
      
      // æ¨¡æ“¬æˆåŠŸ/å¤±æ•—
      if (Math.random() > 0.7) {
        throw new Error('ç¶²è·¯éŒ¯èª¤')
      }
      
      // æ¨¡æ“¬ API éŸ¿æ‡‰æ•¸æ“š
      data.value = {
        users: [
          { id: 1, name: 'å¼µå°æ˜' },
          { id: 2, name: 'æå°è¯' },
          { id: 3, name: 'ç‹å°ç¾' }
        ],
        timestamp: new Date().toISOString()
      }
    } catch (err) {
      error.value = err.message
    } finally {
      loading.value = false
    }
  }
  
  // è‡ªå‹•åŸ·è¡Œä¸€æ¬¡è«‹æ±‚
  Vue.onMounted(fetchData)
  
  return {
    data,
    error,
    loading,
    refetch: fetchData
  }
}</div>
        </div>

        <!-- ç¯„ä¾‹ 5ï¼šè¡¨å–®é©—è¨¼ Composable -->
        <div class="example">
            <h3>ç¯„ä¾‹ 5ï¼šè¡¨å–®é©—è¨¼ Composable - useForm</h3>
            <div class="composable-demo">
                <div id="app5"></div>
            </div>
            <div class="code">
// composables/useForm.js
function useForm(initialValues, validationRules) {
  const values = Vue.reactive({ ...initialValues })
  const errors = Vue.reactive({})
  const touched = Vue.reactive({})
  
  function validateField(fieldName) {
    const rules = validationRules[fieldName]
    if (!rules) return true
    
    const value = values[fieldName]
    
    if (rules.required && !value) {
      errors[fieldName] = 'æ­¤æ¬„ä½ç‚ºå¿…å¡«'
      return false
    }
    
    if (rules.minLength && value.length < rules.minLength) {
      errors[fieldName] = `æœ€å°‘éœ€è¦ ${rules.minLength} å€‹å­—ç¬¦`
      return false
    }
    
    if (rules.email && !/\S+@\S+\.\S+/.test(value)) {
      errors[fieldName] = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„ Email åœ°å€'
      return false
    }
    
    delete errors[fieldName]
    return true
  }
  
  function validateAll() {
    let isValid = true
    for (const fieldName in validationRules) {
      if (!validateField(fieldName)) {
        isValid = false
      }
    }
    return isValid
  }
  
  function handleInput(fieldName, value) {
    values[fieldName] = value
    touched[fieldName] = true
    validateField(fieldName)
  }
  
  const isValid = Vue.computed(() => {
    return Object.keys(errors).length === 0
  })
  
  return {
    values,
    errors,
    touched,
    isValid,
    handleInput,
    validateAll
  }
}</div>
        </div>

        <!-- ç¯„ä¾‹ 6ï¼šçµ„åˆå¤šå€‹ Composables -->
        <div class="example">
            <h3>ç¯„ä¾‹ 6ï¼šçµ„åˆä½¿ç”¨å¤šå€‹ Composables</h3>
            <div class="composable-demo">
                <div id="app6"></div>
            </div>
            <div class="code">
// åœ¨ä¸€å€‹çµ„ä»¶ä¸­çµ„åˆä½¿ç”¨å¤šå€‹ Composables
setup() {
  // æ»‘é¼ è¿½è¸ª
  const { x: mouseX, y: mouseY } = useMouse()
  
  // è¨ˆæ•¸å™¨
  const { count, increment } = useCounter(0)
  
  // æœ¬åœ°å„²å­˜
  const [theme, setTheme] = useLocalStorage('theme', 'light')
  
  // çµ„åˆé‚è¼¯
  const mouseDistance = Vue.computed(() => {
    return Math.sqrt(mouseX.value ** 2 + mouseY.value ** 2)
  })
  
  function toggleTheme() {
    setTheme(theme.value === 'light' ? 'dark' : 'light')
  }
  
  return {
    mouseX,
    mouseY,
    mouseDistance,
    count,
    increment,
    theme,
    toggleTheme
  }
}</div>
            
            <div class="highlight">
                <strong>ğŸ”— çµ„åˆçš„åŠ›é‡ï¼š</strong>Composables å¯ä»¥äº’ç›¸çµ„åˆï¼Œå‰µå»ºæ›´è¤‡é›œçš„åŠŸèƒ½ï¼
            </div>
        </div>

        <!-- ç¯„ä¾‹ 7ï¼šé€²éš Composable æ¨¡å¼ -->
        <div class="example">
            <h3>ç¯„ä¾‹ 7ï¼šé€²éšæ¨¡å¼ - useToggle èˆ‡ useTimeout</h3>
            <div class="composable-demo">
                <div id="app7"></div>
            </div>
            <div class="code">
// composables/useToggle.js
function useToggle(initialValue = false) {
  const value = Vue.ref(initialValue)
  
  function toggle() {
    value.value = !value.value
  }
  
  function setTrue() {
    value.value = true
  }
  
  function setFalse() {
    value.value = false
  }
  
  return [value, { toggle, setTrue, setFalse }]
}

// composables/useTimeout.js  
function useTimeout(callback, delay) {
  const isActive = Vue.ref(false)
  let timeoutId
  
  function start() {
    isActive.value = true
    timeoutId = setTimeout(() => {
      callback()
      isActive.value = false
    }, delay)
  }
  
  function stop() {
    if (timeoutId) {
      clearTimeout(timeoutId)
      isActive.value = false
    }
  }
  
  Vue.onUnmounted(stop)
  
  return { isActive, start, stop }
}</div>
        </div>

        <h2>ğŸ“š Composables è¨­è¨ˆåŸå‰‡</h2>

        <div class="best-practice">
            <h3>âœ… æœ€ä½³å¯¦è¸</h3>
            <ul>
                <li><strong>å‘½åç´„å®šï¼š</strong>ä»¥ <code>use</code> é–‹é ­</li>
                <li><strong>è¿”å›ä¸€è‡´æ€§ï¼š</strong>ç¸½æ˜¯è¿”å› refsï¼Œä¿æŒéŸ¿æ‡‰å¼</li>
                <li><strong>å–®ä¸€è·è²¬ï¼š</strong>æ¯å€‹ Composable å°ˆæ³¨æ–¼ä¸€å€‹ç‰¹å®šåŠŸèƒ½</li>
                <li><strong>å¯çµ„åˆæ€§ï¼š</strong>è¨­è¨ˆæ™‚è€ƒæ…®èˆ‡å…¶ä»– Composables çš„çµ„åˆ</li>
                <li><strong>ç”Ÿå‘½é€±æœŸæ¸…ç†ï¼š</strong>å¦¥å–„ç®¡ç†å‰¯ä½œç”¨å’Œè³‡æºæ¸…ç†</li>
            </ul>
        </div>

        <div class="warning">
            <h3>âš ï¸ å¸¸è¦‹é™·é˜±</h3>
            <ul>
                <li><strong>è¿”å›æ™®é€šå€¼ï¼š</strong>ç¢ºä¿è¿”å› ref æˆ– reactive å°è±¡</li>
                <li><strong>å¿˜è¨˜æ¸…ç†ï¼š</strong>åœ¨ onUnmounted ä¸­æ¸…ç†äº‹ä»¶ç›£è½å™¨</li>
                <li><strong>éåº¦æŠ½è±¡ï¼š</strong>ä¸è¦ç‚ºäº†æŠ½è±¡è€ŒæŠ½è±¡ï¼Œä¿æŒç°¡å–®</li>
                <li><strong>ç‹€æ…‹æ´©æ¼ï¼š</strong>é¿å…åœ¨ Composable ä¸­ä½¿ç”¨å…¨å±€ç‹€æ…‹</li>
            </ul>
        </div>

        <div class="tip-box">
            <h3>ğŸ’¡ ä½•æ™‚ä½¿ç”¨ Composablesï¼Ÿ</h3>
            <ul>
                <li>æœ‰ç‹€æ…‹çš„é‚è¼¯éœ€è¦åœ¨å¤šå€‹çµ„ä»¶ä¹‹é–“å¾©ç”¨</li>
                <li>è¤‡é›œçš„ç‹€æ…‹ç®¡ç†å’Œå‰¯ä½œç”¨éœ€è¦å°è£</li>
                <li>èˆ‡ç€è¦½å™¨ API çš„äº’å‹•ï¼ˆlocalStorageã€äº‹ä»¶ç›£è½ç­‰ï¼‰</li>
                <li>API è«‹æ±‚å’Œæ•¸æ“šç®¡ç†</li>
                <li>è¡¨å–®è™•ç†å’Œé©—è¨¼é‚è¼¯</li>
            </ul>
        </div>

        <h2>ğŸ“– é‡é»ç¸½çµ</h2>
        <ul>
            <li><strong>Composables</strong> æ˜¯ Vue 3 ä¸­å¾©ç”¨é‚è¼¯çš„å¼·å¤§å·¥å…·</li>
            <li>éµå¾ª <strong>use-</strong> å‘½åç´„å®šï¼Œè¿”å›éŸ¿æ‡‰å¼æ•¸æ“š</li>
            <li>å¯ä»¥<strong>çµ„åˆä½¿ç”¨</strong>å¤šå€‹ Composables å‰µå»ºè¤‡é›œåŠŸèƒ½</li>
            <li>é©åˆå°è£èˆ‡<strong>ç€è¦½å™¨ API</strong>ã€<strong>ç‹€æ…‹ç®¡ç†</strong>ç›¸é—œçš„é‚è¼¯</li>
            <li>æ³¨æ„<strong>ç”Ÿå‘½é€±æœŸç®¡ç†</strong>å’Œ<strong>è³‡æºæ¸…ç†</strong></li>
        </ul>

        <h2>ğŸ¯ ä¸‹ä¸€æ­¥</h2>
        <ul>
            <li><a href="04-lifecycle.html">â† ä¸Šä¸€èª²ï¼šç”Ÿå‘½é€±æœŸé‰¤å­</a></li>
            <li><a href="06-advanced.html">ä¸‹ä¸€èª²ï¼šé€²éšç‰¹æ€§ â†’</a></li>
        </ul>
    </div>

    <script>
        const { createApp, ref, reactive, computed, onMounted, onUnmounted, watch } = Vue
        
        // Composables å®šç¾©
        
        // useCounter Composable
        function useCounter(initialValue = 0) {
            const count = ref(initialValue)
            
            function increment() {
                count.value++
            }
            
            function decrement() {
                count.value--
            }
            
            function reset() {
                count.value = initialValue
            }
            
            return {
                count,
                increment,
                decrement,
                reset
            }
        }
        
        // useMouse Composable
        function useMouse() {
            const x = ref(0)
            const y = ref(0)
            
            function updateMouse(event) {
                x.value = event.clientX
                y.value = event.clientY
            }
            
            onMounted(() => {
                window.addEventListener('mousemove', updateMouse)
            })
            
            onUnmounted(() => {
                window.removeEventListener('mousemove', updateMouse)
            })
            
            return { x, y }
        }
        
        // useLocalStorage Composable
        function useLocalStorage(key, defaultValue) {
            function read() {
                try {
                    const item = window.localStorage.getItem(key)
                    return item ? JSON.parse(item) : defaultValue
                } catch {
                    return defaultValue
                }
            }
            
            const storedValue = ref(read())
            
            function setValue(value) {
                try {
                    storedValue.value = value
                    window.localStorage.setItem(key, JSON.stringify(value))
                } catch (error) {
                    console.error(`Error setting localStorage key "${key}":`, error)
                }
            }
            
            return [storedValue, setValue]
        }
        
        // useFetch Composable
        function useFetch() {
            const data = ref(null)
            const error = ref(null)
            const loading = ref(false)
            
            async function fetchData() {
                loading.value = true
                error.value = null
                
                try {
                    await new Promise(resolve => setTimeout(resolve, 1000))
                    
                    if (Math.random() > 0.7) {
                        throw new Error('æ¨¡æ“¬ç¶²è·¯éŒ¯èª¤')
                    }
                    
                    data.value = {
                        users: [
                            { id: 1, name: 'å¼µå°æ˜', role: 'é–‹ç™¼è€…' },
                            { id: 2, name: 'æå°è¯', role: 'è¨­è¨ˆå¸«' },
                            { id: 3, name: 'ç‹å°ç¾', role: 'ç”¢å“ç¶“ç†' },
                            { id: 4, name: 'é™³å¤§é›„', role: 'QA å·¥ç¨‹å¸«' }
                        ],
                        timestamp: new Date().toLocaleTimeString()
                    }
                } catch (err) {
                    error.value = err.message
                } finally {
                    loading.value = false
                }
            }
            
            return {
                data,
                error,
                loading,
                refetch: fetchData
            }
        }
        
        // useForm Composable
        function useForm(initialValues, validationRules) {
            const values = reactive({ ...initialValues })
            const errors = reactive({})
            const touched = reactive({})
            
            function validateField(fieldName) {
                const rules = validationRules[fieldName]
                if (!rules) return true
                
                const value = values[fieldName]
                
                if (rules.required && !value) {
                    errors[fieldName] = 'æ­¤æ¬„ä½ç‚ºå¿…å¡«'
                    return false
                }
                
                if (rules.minLength && value.length < rules.minLength) {
                    errors[fieldName] = `æœ€å°‘éœ€è¦ ${rules.minLength} å€‹å­—ç¬¦`
                    return false
                }
                
                if (rules.email && !/\S+@\S+\.\S+/.test(value)) {
                    errors[fieldName] = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„ Email åœ°å€'
                    return false
                }
                
                delete errors[fieldName]
                return true
            }
            
            function validateAll() {
                let isValid = true
                for (const fieldName in validationRules) {
                    if (!validateField(fieldName)) {
                        isValid = false
                    }
                }
                return isValid
            }
            
            function handleInput(fieldName, value) {
                values[fieldName] = value
                touched[fieldName] = true
                validateField(fieldName)
            }
            
            const isValid = computed(() => {
                return Object.keys(errors).length === 0
            })
            
            return {
                values,
                errors,
                touched,
                isValid,
                handleInput,
                validateAll
            }
        }
        
        // useToggle Composable
        function useToggle(initialValue = false) {
            const value = ref(initialValue)
            
            function toggle() {
                value.value = !value.value
            }
            
            function setTrue() {
                value.value = true
            }
            
            function setFalse() {
                value.value = false
            }
            
            return [value, { toggle, setTrue, setFalse }]
        }
        
        // useTimeout Composable
        function useTimeout(callback, delay) {
            const isActive = ref(false)
            let timeoutId
            
            function start() {
                if (timeoutId) {
                    clearTimeout(timeoutId)
                }
                isActive.value = true
                timeoutId = setTimeout(() => {
                    callback()
                    isActive.value = false
                }, delay)
            }
            
            function stop() {
                if (timeoutId) {
                    clearTimeout(timeoutId)
                    isActive.value = false
                }
            }
            
            onUnmounted(stop)
            
            return { isActive, start, stop }
        }
        
        // æ‡‰ç”¨å¯¦ä¾‹
        
        // ç¯„ä¾‹ 1ï¼šåŸºç¤è¨ˆæ•¸å™¨
        createApp({
            template: `
                <div>
                    <h4>ğŸ§® è¨ˆæ•¸å™¨ Composable</h4>
                    <p>è¨ˆæ•¸ï¼š{{ count }}</p>
                    <button @click="increment">+1</button>
                    <button @click="decrement">-1</button>
                    <button @click="reset">é‡ç½®</button>
                </div>
            `,
            setup() {
                const { count, increment, decrement, reset } = useCounter(10)
                return { count, increment, decrement, reset }
            }
        }).mount('#app1')
        
        // ç¯„ä¾‹ 2ï¼šæ»‘é¼ è¿½è¸ª
        createApp({
            template: `
                <div>
                    <h4>ğŸ–±ï¸ æ»‘é¼ ä½ç½®è¿½è¸ª</h4>
                    <p>æ»‘é¼ ä½ç½®ï¼š{{ x }}, {{ y }}</p>
                    <p>è·é›¢åŸé»ï¼š{{ distance.toFixed(0) }} px</p>
                    <div style="width: 100%; height: 100px; background: #f0f8ff; border: 2px dashed #16a085; 
                                display: flex; align-items: center; justify-content: center; margin: 10px 0;">
                        åœ¨æ­¤å€åŸŸç§»å‹•æ»‘é¼ è©¦è©¦
                    </div>
                </div>
            `,
            setup() {
                const { x, y } = useMouse()
                
                const distance = computed(() => {
                    return Math.sqrt(x.value ** 2 + y.value ** 2)
                })
                
                return { x, y, distance }
            }
        }).mount('#app2')
        
        // ç¯„ä¾‹ 3ï¼šæœ¬åœ°å„²å­˜
        createApp({
            template: `
                <div>
                    <h4>ğŸ’¾ æœ¬åœ°å„²å­˜</h4>
                    <p>ç•¶å‰åå­—ï¼š{{ name || 'ï¼ˆæœªè¨­ç½®ï¼‰' }}</p>
                    <input v-model="inputName" placeholder="è¼¸å…¥ä½ çš„åå­—">
                    <button @click="saveName">ğŸ’¾ ä¿å­˜åˆ° localStorage</button>
                    <button @click="clearName">ğŸ—‘ï¸ æ¸…é™¤</button>
                    <p><small>é‡æ–°åŠ è¼‰é é¢å¾Œæ•¸æ“šä»ç„¶å­˜åœ¨</small></p>
                </div>
            `,
            setup() {
                const [name, setName] = useLocalStorage('userName', '')
                const inputName = ref('')
                
                function saveName() {
                    if (inputName.value.trim()) {
                        setName(inputName.value.trim())
                        inputName.value = ''
                    }
                }
                
                function clearName() {
                    setName('')
                }
                
                return { name, inputName, saveName, clearName }
            }
        }).mount('#app3')
        
        // ç¯„ä¾‹ 4ï¼šAPI è«‹æ±‚
        createApp({
            template: `
                <div>
                    <h4>ğŸ“¡ API è«‹æ±‚</h4>
                    <button @click="refetch" :disabled="loading">
                        {{ loading ? 'â³ è¼‰å…¥ä¸­...' : 'ğŸ”„ ç²å–ç”¨æˆ¶æ•¸æ“š' }}
                    </button>
                    
                    <div v-if="error" style="color: red; margin: 10px 0;">
                        âŒ éŒ¯èª¤ï¼š{{ error }}
                    </div>
                    
                    <div v-if="data && !loading">
                        <h5>ğŸ‘¥ ç”¨æˆ¶åˆ—è¡¨ ({{ data.timestamp }})ï¼š</h5>
                        <ul>
                            <li v-for="user in data.users" :key="user.id">
                                {{ user.name }} - {{ user.role }}
                            </li>
                        </ul>
                    </div>
                </div>
            `,
            setup() {
                const { data, error, loading, refetch } = useFetch()
                return { data, error, loading, refetch }
            }
        }).mount('#app4')
        
        // ç¯„ä¾‹ 5ï¼šè¡¨å–®é©—è¨¼
        createApp({
            template: `
                <div>
                    <h4>ğŸ“ è¡¨å–®é©—è¨¼</h4>
                    <form @submit.prevent="handleSubmit">
                        <div style="margin: 10px 0;">
                            <input 
                                :value="values.name"
                                @input="handleInput('name', $event.target.value)"
                                placeholder="å§“å (å¿…å¡«ï¼Œè‡³å°‘ 2 å­—ç¬¦)"
                                :style="errors.name ? 'border-color: red' : ''"
                            >
                            <div v-if="errors.name" style="color: red; font-size: 0.9em;">
                                {{ errors.name }}
                            </div>
                        </div>
                        
                        <div style="margin: 10px 0;">
                            <input 
                                :value="values.email"
                                @input="handleInput('email', $event.target.value)"
                                placeholder="Email (å¿…å¡«)"
                                :style="errors.email ? 'border-color: red' : ''"
                            >
                            <div v-if="errors.email" style="color: red; font-size: 0.9em;">
                                {{ errors.email }}
                            </div>
                        </div>
                        
                        <button type="submit" :disabled="!isValid">
                            {{ isValid ? 'âœ… æäº¤' : 'âŒ è«‹ä¿®æ­£éŒ¯èª¤' }}
                        </button>
                    </form>
                    
                    <div v-if="submitMessage" style="margin: 10px 0; color: green;">
                        {{ submitMessage }}
                    </div>
                </div>
            `,
            setup() {
                const { values, errors, touched, isValid, handleInput, validateAll } = useForm(
                    { name: '', email: '' },
                    {
                        name: { required: true, minLength: 2 },
                        email: { required: true, email: true }
                    }
                )
                
                const submitMessage = ref('')
                
                function handleSubmit() {
                    if (validateAll()) {
                        submitMessage.value = `âœ… è¡¨å–®æäº¤æˆåŠŸï¼å§“åï¼š${values.name}ï¼ŒEmailï¼š${values.email}`
                        setTimeout(() => {
                            submitMessage.value = ''
                        }, 3000)
                    }
                }
                
                return {
                    values,
                    errors,
                    isValid,
                    handleInput,
                    handleSubmit,
                    submitMessage
                }
            }
        }).mount('#app5')
        
        // ç¯„ä¾‹ 6ï¼šçµ„åˆä½¿ç”¨
        createApp({
            template: `
                <div>
                    <h4>ğŸ”— çµ„åˆä½¿ç”¨å¤šå€‹ Composables</h4>
                    <p>ä¸»é¡Œï¼š{{ theme }} | æ»‘é¼ ï¼š({{ mouseX }}, {{ mouseY }}) | è¨ˆæ•¸ï¼š{{ count }}</p>
                    <p>æ»‘é¼ è·é›¢åŸé»ï¼š{{ mouseDistance.toFixed(0) }} px</p>
                    
                    <button @click="toggleTheme">
                        ğŸ¨ åˆ‡æ›ä¸»é¡Œ ({{ theme === 'light' ? 'â†’ æ·±è‰²' : 'â†’ æ·ºè‰²' }})
                    </button>
                    <button @click="increment">ğŸ“Š è¨ˆæ•¸ +1</button>
                </div>
            `,
            setup() {
                const { x: mouseX, y: mouseY } = useMouse()
                const { count, increment } = useCounter(0)
                const [theme, setTheme] = useLocalStorage('composable-theme', 'light')
                
                const mouseDistance = computed(() => {
                    return Math.sqrt(mouseX.value ** 2 + mouseY.value ** 2)
                })
                
                function toggleTheme() {
                    setTheme(theme.value === 'light' ? 'dark' : 'light')
                }
                
                return {
                    mouseX,
                    mouseY,
                    mouseDistance,
                    count,
                    increment,
                    theme,
                    toggleTheme
                }
            }
        }).mount('#app6')
        
        // ç¯„ä¾‹ 7ï¼šé€²éšæ¨¡å¼
        createApp({
            template: `
                <div>
                    <h4>â° é€²éšçµ„åˆï¼šToggle + Timeout</h4>
                    <p>æ¶ˆæ¯é¡¯ç¤ºç‹€æ…‹ï¼š{{ isVisible ? 'ğŸŸ¢ é¡¯ç¤ºä¸­' : 'ğŸ”´ å·²éš±è—' }}</p>
                    
                    <div v-if="isVisible" style="background: #d4edda; border: 1px solid #c3e6cb; 
                                                 padding: 10px; border-radius: 4px; margin: 10px 0;">
                        {{ message }}
                    </div>
                    
                    <div>
                        <button @click="actions.toggle">
                            {{ isVisible ? 'éš±è—' : 'é¡¯ç¤º' }} æ¶ˆæ¯
                        </button>
                        <button @click="showTemporarily" :disabled="timeoutActive">
                            {{ timeoutActive ? 'â³ è‡ªå‹•éš±è—ä¸­...' : 'â° é¡¯ç¤º 3 ç§’' }}
                        </button>
                        <button @click="actions.setFalse">ğŸ”´ ç«‹å³éš±è—</button>
                    </div>
                    
                    <p><small>ç¤ºç¯„äº† useToggle å’Œ useTimeout çš„çµ„åˆä½¿ç”¨</small></p>
                </div>
            `,
            setup() {
                const [isVisible, actions] = useToggle(false)
                const message = ref('ğŸ‰ é€™æ˜¯ä¸€æ¢è‡¨æ™‚æ¶ˆæ¯ï¼')
                
                const { isActive: timeoutActive, start: startTimeout } = useTimeout(() => {
                    actions.setFalse()
                }, 3000)
                
                function showTemporarily() {
                    actions.setTrue()
                    startTimeout()
                }
                
                return {
                    isVisible,
                    actions,
                    message,
                    timeoutActive,
                    showTemporarily
                }
            }
        }).mount('#app7')
    </script>
</body>
</html>